machine:
    environment:
        PATH: /home/ubuntu/miniconda/envs/test_env/bin:/home/ubuntu/miniconda/bin:$PATH
    post:
        - pyenv global 3.4.4 3.5.2

dependencies:
    post:
        - case $CIRCLE_NODE_INDEX in 0) pip install -r requirements-tests.txt ;; esac:
            parallel: false
        - case $CIRCLE_NODE_INDEX in 0) python setup.py install ;; 1) python setup.py install ;; esac:
            parallel: true

test:
    override:
        - case $CIRCLE_NODE_INDEX in 0) py.test --flake8 --timeout=10 --cov=./slug;; 1) py.test --timeout=10 ;; esac:
            parallel: true
